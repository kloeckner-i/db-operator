apiVersion: kci.rocks/v1alpha1
kind: DbInstance
metadata:
  name: example-gsql
spec:
  adminSecretRef:
    Name: example-instance-admin-secret
    Namespace: operator
  engine: postgres
  google:
    instance: dboperator-example-gsql
    apiEndpoint: http://192.168.177.25:8080
    configmapRef:
      Name: example-gsql-config
      Namespace: operator
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: example-gsql-config
  namespace: operator
data:
  config: |
    {
      "databaseVersion": "POSTGRES_9_6",
      "settings": {
        "tier": "db-f1-micro",
        "availabilityType": "ZONAL",
        "pricingPlan": "PER_USE",
        "replicationType": "SYNCHRONOUS",
        "activationPolicy": "ALWAYS",
        "dataDiskType": "PD_SSD",
        "backupConfiguration": {
          "enabled": false
        },
        "storageAutoResizeLimit": "0",
        "storageAutoResize": true
      },
      "backendType": "SECOND_GEN",
      "region": "europe-west1"
    }
---
apiVersion: v1
kind: Secret
metadata:
  name: example-instance-admin-secret
  namespace: operator
type: Opaque
data:
  user: cG9zdGdyZXM=
  password: c2VjdXJlcGFzc3dvcmQK